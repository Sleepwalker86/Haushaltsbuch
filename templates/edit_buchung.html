{% extends "base.html" %}
{% block content %}
<div style="margin-top:16px; display:flex; align-items:center; gap:16px; justify-content:space-between;">
  <h1 style="margin:0;">Buchung bearbeiten</h1>
  <a href="{{ url_for('dashboard', year=request.args.get('year'), month=request.args.get('month'), page=request.args.get('page', 1)) }}">
    <button type="button">Zurück zum Dashboard</button>
  </a>
</div>

{% if get_flashed_messages() %}
  <div class="messages">
    {% for msg in get_flashed_messages(with_categories=true) %}
      {% set cat, text = msg %}
      <div class="msg {{ cat }}">{{ text }}</div>
    {% endfor %}
  </div>
{% endif %}

<form method="post">
  <div>
    <label for="datum">Datum</label>
    <input type="date" id="datum" name="datum" value="{{ buchung.datum.strftime('%Y-%m-%d') if buchung.datum else '' }}" required>
  </div>

  <div>
    <label for="art">Art</label>
    <input type="text" id="art" name="art" value="{{ buchung.art }}" placeholder="z.B. Überweisung, Barzahlung">
  </div>

  <div>
    <label for="typ">Typ</label>
    <select id="typ" name="typ" required>
      <option value="Ausgaben" {% if buchung.soll > 0 %}selected{% endif %}>Ausgaben</option>
      <option value="Einnahmen" {% if buchung.haben > 0 %}selected{% endif %}>Einnahmen</option>
    </select>
  </div>

  <div>
    <label for="betrag">Betrag</label>
    <input type="text" id="betrag" name="betrag" 
           value="{% if buchung.soll > 0 %}{{ "%.2f"|format(buchung.soll) }}{% elif buchung.haben > 0 %}{{ "%.2f"|format(buchung.haben) }}{% else %}0.00{% endif %}" 
           inputmode="decimal" placeholder="z.B. 25,50" required>
  </div>

  <div>
    <label for="kategorie">Kategorie</label>
    <select id="kategorie" name="kategorie" required>
      <option value="">Bitte wählen</option>
      {% for k in kategorien %}
        <option value="{{ k }}" {% if k == buchung.kategorie %}selected{% endif %}>{{ k }}</option>
      {% endfor %}
    </select>
  </div>

  <div>
    <label for="beschreibung">Beschreibung</label>
    <textarea id="beschreibung" name="beschreibung" rows="3" placeholder="z.B. Barzahlung Supermarkt" required>{{ buchung.beschreibung }}</textarea>
  </div>

  <button type="submit">Speichern</button>
</form>
{% endblock %}


# docker-compose.yml für externe Datenbank
# Verwendung: docker compose -f docker-compose.external-db.yml up -d
#
# WICHTIG: Vor dem Start müssen in der .env Datei folgende Parameter gesetzt sein:
#   DB_HOST=192.168.10.99          # IP-Adresse der externen DB
#   DB_USER=smo                     # Datenbankbenutzer
#   DB_PASSWORD=1234                # Passwort
#   DB_NAME=Haushaltsbuch_test      # Datenbankname
#   SECRET_KEY=...                  # Flask Secret Key
#   APP_PORT=5001                   # Port für die App (optional)

name: finanzapp

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: finanzapp
    restart: unless-stopped
    # Kein depends_on, da externe DB verwendet wird
    environment:
      - FLASK_DEBUG=${FLASK_DEBUG:-0}
      - DB_HOST=${DB_HOST}
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_NAME=${DB_NAME}
      - SECRET_KEY=${SECRET_KEY}
      - PAPERLESS_IP=${PAPERLESS_IP:-}
      - PAPERLESS_TOKEN=${PAPERLESS_TOKEN:-}
      - PAPERLESS_DOCUMENT_TYPE_ID=${PAPERLESS_DOCUMENT_TYPE_ID:-}
      - PAPERLESS_ENABLED=${PAPERLESS_ENABLED:-false}
    volumes:
      - ./import:/app/import
      - ./image:/app/image
    ports:
      - "${APP_PORT:-5001}:5001"
    networks:
      - finanzapp_network

networks:
  finanzapp_network:
    driver: bridge
